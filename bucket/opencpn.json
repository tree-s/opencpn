{
    "version": "5.12.4",
    "description": "OpenCPN â€“ a concise ChartPlotter and Navigator",
    "homepage": "https://opencpn.org/",
    "license": "GPL-2.0-or-later",

    "url": "https://github.com/OpenCPN/OpenCPN/releases/download/Release_5.12.4/opencpn_5.12.4-0+3720.37fd0cd_setup.exe",
    "hash": "e949f55de57611afe2fc0dad5a8ac33795c46ba488cb40ca07b65f639a07b8aa",

    "installer": {
        "script": [
            "7z x \"$dir\\$fname\" -o\"$dir\" -y",
            "Remove-Item \"$dir\\$fname\" -Force",
    
            "# Find extracted OpenCPN.exe",
            "$exe = Get-ChildItem -Path $dir -Recurse -Filter OpenCPN.exe | Select-Object -First 1",
            "if (-not $exe) { throw 'OpenCPN.exe not found after extraction' }",
    
            "# Move extracted files to app root",
            "$src = $exe.Directory.FullName",
            "Get-ChildItem -Path $src -Force | ForEach-Object { Move-Item $_.FullName $dir -Force }",
    
            "# Cleanup empty directories",
            "Get-ChildItem -Path $src -Recurse -Force | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue"
        ]
    },
    
    "bin": "OpenCPN.exe",

    "checkver": {
        "github": "https://github.com/OpenCPN/OpenCPN",
        "regex": "opencpn_(?<version>[\\d.]+)-[\\d+\\.a-f]+_setup\\.exe"
    },

    "autoupdate": {
        "url": "https://github.com/OpenCPN/OpenCPN/releases/download/Release_$version/$match"
    }
}
